ğŸ“– è¯¦ç»†ä½¿ç”¨æŒ‡å— - data_dealer_auto
================================================================================

å®Œæ•´çš„Pick/Placeæ•°æ®é›†è‡ªåŠ¨åŒ–å¤„ç†æŒ‡å—

ğŸ“š ç›®å½•
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. åŸºæœ¬æ¦‚å¿µ
2. å¿«é€Ÿå¼€å§‹
3. è¯¦ç»†å‚æ•°è¯´æ˜
4. ä½¿ç”¨æ¡ˆä¾‹
5. è¾“å‡ºè¯´æ˜
6. å¸¸è§é—®é¢˜
7. æ•…éšœæ’é™¤
8. æ‰©å±•å’Œè‡ªå®šä¹‰

1ï¸âƒ£ åŸºæœ¬æ¦‚å¿µ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Pick/Placeæ£€æµ‹åŸç†
  æœºå™¨äººåŠ¨ä½œå‘é‡æœ‰7ä¸ªç»´åº¦ï¼š
  [xå¹³ç§», yå¹³ç§», zå¹³ç§», Î±æ—‹è½¬, Î²æ—‹è½¬, Î³æ—‹è½¬, å¤¹çˆªçŠ¶æ€]
                                              â†‘ ç¬¬7ç»´

  å¤¹çˆªçŠ¶æ€èŒƒå›´ï¼š-1.0ï¼ˆæ‰“å¼€ï¼‰åˆ° 1.0ï¼ˆå…³é—­ï¼‰
  
  å…³é”®åŠ¨ä½œï¼š
    -1.0 â†’ 1.0ï¼ˆä»æ‰“å¼€åˆ°å…³é—­ï¼‰= PICK æ“ä½œ
     1.0 â†’ -1.0ï¼ˆä»å…³é—­åˆ°æ‰“å¼€ï¼‰= PLACE æ“ä½œ

å¸§èŒƒå›´æå–
  å…³é”®å¸§ç´¢å¼•ï¼ši
  æå–èŒƒå›´ï¼š[max(0, i-30), min(æ€»å¸§æ•°, i+31)]
  æ€»å¸§æ•°ï¼š60å¸§ï¼ˆæˆ–æ›´å°‘ï¼Œé è¿‘è¾¹ç•Œæ—¶ï¼‰
  
  ç›®çš„ï¼šæ•æ‰å®Œæ•´çš„æ“ä½œè¿‡ç¨‹
    â”œâ”€ å‰30å¸§ï¼šæ¥è¿‘ç›®æ ‡ã€å®šä½
    â”œâ”€ å½“å‰å¸§ï¼šå…³é”®åŠ¨ä½œï¼ˆå¤¹çˆªæ”¹å˜ï¼‰
    â””â”€ å30å¸§ï¼šæ‰§è¡Œæ“ä½œã€è¿”å›

ä»»åŠ¡æè¿°ç”Ÿæˆ
  åŸå§‹ä»»åŠ¡ï¼šä»æ•°æ®é›†å…ƒæ•°æ®è·å–
  æ–°ä»»åŠ¡ï¼šæ ¹æ®æ“ä½œç±»å‹è‡ªåŠ¨ç”Ÿæˆ
    ä¾‹ï¼šåŸå§‹ä»»åŠ¡ "put both moka pots on the stove"
        pickæ“ä½œ â†’ "pick up the moka pot"
        placeæ“ä½œ â†’ "put the moka pot on the stove"

2ï¸âƒ£ å¿«é€Ÿå¼€å§‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸŒŸ æ¨èï¼šä½¿ç”¨Azure OpenAI GPT-5è·å¾—æœ€ä½³ä»»åŠ¡æè¿°è´¨é‡

å¦‚æœä½ æœ‰Azure OpenAIä¼ä¸šè´¦å·ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨GPT-5ï¼š
  
  python auto_cut_dataset.py \
    --end-idx 500 \
    --before-frames 15 \
    --after-frames 10 \
    --llm-provider gpt \
    --llm-api-key 5ffef770a5b148c5920b7b16329e30fa \
    --llm-api-base https://gpt.yunstorm.com/ \
    --llm-api-version 2025-01-01-preview \
    --llm-model gpt-5 \
    --save-mode image

  ä¼˜åŠ¿ï¼š
    âœ“ GPT-5è§†è§‰ç†è§£èƒ½åŠ›ï¼Œç²¾å‡†è¯†åˆ«æ“ä½œå¯¹è±¡
    âœ“ åˆ†æå¤šå¸§å›¾åƒï¼ˆé¦–å¸§ã€å…³é”®å¸§ã€å°¾å¸§ï¼‰
    âœ“ æ”¯æŒåŒæ‘„åƒå¤´è§†è§’åˆ†æ
    âœ“ ç”Ÿæˆè‡ªç„¶ã€å‡†ç¡®çš„ä»»åŠ¡æè¿°
  
  æµ‹è¯•APIå¯ç”¨æ€§ï¼špython test_azure_gpt.py

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æœ€ç®€å•çš„3æ­¥ï¼ˆæœ¬åœ°æ–¹å¼ï¼Œæ— éœ€APIï¼‰ï¼š

ç¬¬1æ­¥ï¼šè¿›å…¥ç›®å½•
  cd /home/dongyingyibadao/data_dealer_auto

ç¬¬2æ­¥ï¼šåˆ†ææ•°æ®ï¼ˆä»…æ£€æµ‹ï¼Œä¸è½¬æ¢ï¼‰
  python auto_cut_dataset.py --end-idx 10000 --skip-cutting
  
  âœ“ å¿«é€Ÿç”Ÿæˆåˆ†ææŠ¥å‘Š
  âœ“ ä¸å ç”¨å¤§é‡ç£ç›˜ç©ºé—´
  âœ“ è¾“å‡ºï¼šcut_dataset/frame_ranges_info.json

ç¬¬3æ­¥ï¼šæ‰§è¡Œå®Œæ•´å¤„ç†
  python auto_cut_dataset.py --end-idx 10000 --max-episodes 100
  
  âœ“ è½¬æ¢ä¸ºLeRobotæ ¼å¼
  âœ“ è¾“å‡ºï¼šcut_dataset/meta å’Œ cut_dataset/data
  âœ“ æ•°æ®æŒ‰åŸå§‹episodeå½’ç±»ï¼šcut_dataset/data/episode_{id}/segment_{id}.parquet

3ï¸âƒ£ è¯¦ç»†å‚æ•°è¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

python auto_cut_dataset.py [OPTIONS]

--dataset-path PATH
  è¯´æ˜ï¼šè¾“å…¥æ•°æ®é›†è·¯å¾„
  é»˜è®¤ï¼š/home/dongyingyibadao/HuggingFaceVLA_cus/libero
  ç¤ºä¾‹ï¼š--dataset-path /path/to/dataset

--output-dir PATH
  è¯´æ˜ï¼šè¾“å‡ºç›®å½•
  é»˜è®¤ï¼š./cut_datasetï¼ˆå½“å‰ç›®å½•ä¸‹ï¼‰
  ç¤ºä¾‹ï¼š--output-dir /tmp/output_data

--start-idx INDEX
  è¯´æ˜ï¼šå¼€å§‹å¤„ç†çš„å¸§ç´¢å¼•
  é»˜è®¤ï¼š0
  ç¤ºä¾‹ï¼š--start-idx 1000

--end-idx INDEX
  è¯´æ˜ï¼šç»“æŸå¤„ç†çš„å¸§ç´¢å¼•
  é»˜è®¤ï¼šNoneï¼ˆå¤„ç†æ‰€æœ‰æ•°æ®ï¼‰
  ç”¨é€”ï¼šç”¨äºæµ‹è¯•å’Œæ§åˆ¶æ•°æ®é‡
  ç¤ºä¾‹ï¼š--end-idx 50000
  æ³¨æ„ï¼šä¸æŒ‡å®šæ—¶å°†å¤„ç†å®Œæ•´æ•°æ®é›†

--before-frames N
  è¯´æ˜ï¼šå…³é”®å¸§å‰å–çš„å¸§æ•°
  é»˜è®¤ï¼š30
  ç”¨é€”ï¼šè°ƒæ•´åŠ¨ä½œå‰æ‘‡é•¿åº¦
  ç¤ºä¾‹ï¼š--before-frames 40

--after-frames N
  è¯´æ˜ï¼šå…³é”®å¸§åå–çš„å¸§æ•°
  é»˜è®¤ï¼š30
  ç”¨é€”ï¼šè°ƒæ•´åŠ¨ä½œåæ‘‡é•¿åº¦
  ç¤ºä¾‹ï¼š--after-frames 20

--max-episodes N
  è¯´æ˜ï¼šæœ€å¤šä¿å­˜çš„episodeæ•°é‡
  é»˜è®¤ï¼šNoneï¼ˆå…¨éƒ¨ä¿å­˜ï¼‰
  ç”¨é€”ï¼šé™åˆ¶è¾“å‡ºæ–‡ä»¶å¤§å°
  ç¤ºä¾‹ï¼š--max-episodes 100

--llm-provider PROVIDER
  è¯´æ˜ï¼šä»»åŠ¡æè¿°ç”Ÿæˆä½¿ç”¨çš„LLM
  é€‰é¡¹ï¼šlocal, qwen, deepseek, gpt
  é»˜è®¤ï¼šlocal
  æ³¨æ„ï¼šä½¿ç”¨gptéœ€è¦æä¾›API Keyï¼Œä¸”æ”¯æŒVLMï¼ˆè§†è§‰è¯­è¨€æ¨¡å‹ï¼‰
  ç¤ºä¾‹ï¼š--llm-provider gpt

--llm-api-key KEY
  è¯´æ˜ï¼šLLM APIå¯†é’¥
  ç”¨é€”ï¼šç”¨äºqwen, deepseek, gpt
  ç¤ºä¾‹ï¼š--llm-api-key sk-xxxxxx

--llm-api-base URL
  è¯´æ˜ï¼šLLM APIåŸºç¡€URL
  ç”¨é€”ï¼šç”¨äºè‡ªå®šä¹‰APIç«¯ç‚¹æˆ–Azure OpenAI
  é»˜è®¤ï¼šæ ¹æ®providerè‡ªåŠ¨é€‰æ‹©
  ç¤ºä¾‹ï¼š--llm-api-base https://gpt.yunstorm.com/

--llm-api-version VERSION
  è¯´æ˜ï¼šLLM APIç‰ˆæœ¬
  ç”¨é€”ï¼šä»…ç”¨äºAzure OpenAIæœåŠ¡
  ç¤ºä¾‹ï¼š--llm-api-version 2025-01-01-preview

--llm-model MODEL
  è¯´æ˜ï¼šæŒ‡å®šLLMæ¨¡å‹åç§°
  ç”¨é€”ï¼šè¦†ç›–é»˜è®¤æ¨¡å‹
  æ”¯æŒçš„æ¨¡å‹ï¼ˆéœ€è¦Visionèƒ½åŠ›ï¼‰ï¼š
    - gpt-5ï¼ˆæœ€æ–°ï¼Œæ¨èï¼‰
    - gpt-4.1, gpt-4.1-mini
    - gpt-4o, gpt-4o-mini
    - gpt-4-turbo
  ç¤ºä¾‹ï¼š--llm-model gpt-5

--llm-fast-mode
  è¯´æ˜ï¼šGPTå¿«é€Ÿæ¨¡å¼ï¼ˆä»…ä¸Šä¼ 2å¸§å›¾åƒï¼‰
  ç±»å‹ï¼šå¸ƒå°”æ ‡å¿—ï¼ˆæ— å‚æ•°ï¼‰
  ç”¨é€”ï¼šåŠ å¿«å¤„ç†é€Ÿåº¦ï¼Œé™ä½APIè°ƒç”¨æˆæœ¬
  è¯´æ˜ï¼š
    - ç²¾ç»†æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼šä¸Šä¼ 6å¸§ï¼ˆcam1å’Œcam2å„3å¸§ï¼‰
    - å¿«é€Ÿæ¨¡å¼ï¼šä»…ä¸Šä¼ 2å¸§ï¼ˆcam1çš„é¦–å°¾å¸§ï¼‰
    - é€Ÿåº¦æå‡ï¼šçº¦3å€
  ç¤ºä¾‹ï¼š--llm-fast-mode

--checkpoint-interval N
  è¯´æ˜ï¼šcheckpointä¿å­˜é—´éš”ï¼ˆæ¯å¤„ç†Nä¸ªä»»åŠ¡ä¿å­˜ä¸€æ¬¡ï¼‰
  é»˜è®¤ï¼š10
  ç”¨é€”ï¼šé˜²æ­¢é•¿æ—¶é—´è¿è¡Œæ—¶æ•°æ®ä¸¢å¤±
  ç¤ºä¾‹ï¼š--checkpoint-interval 20
  è¾“å‡ºï¼š./cut_dataset/checkpoints/checkpoint_*.json

--resume-from FILE
  è¯´æ˜ï¼šä»checkpointæ–‡ä»¶æ¢å¤è¿è¡Œ
  ç”¨é€”ï¼šä¸­æ–­åç»§ç»­å¤„ç†ï¼Œä¸ä¼šé‡å¤å·²å®Œæˆçš„ä»»åŠ¡
  ç¤ºä¾‹ï¼š--resume-from ./cut_dataset/checkpoints/checkpoint_latest.json
  æ³¨æ„ï¼šéœ€è¦ä½¿ç”¨ä¸ä¸­æ–­å‰ç›¸åŒçš„å‚æ•°

--llm-provider {local, qwen, deepseek, gpt}
  è¯´æ˜ï¼šä»»åŠ¡æè¿°ç”Ÿæˆæ–¹æ³•
  é€‰é¡¹ï¼š
    local     - æ— éœ€APIï¼Œä½¿ç”¨è§„åˆ™ç”Ÿæˆï¼ˆé»˜è®¤ï¼‰
    qwen      - è°ƒç”¨é˜¿é‡ŒQwenæ¨¡å‹ï¼ˆéœ€è¦APIå¯†é’¥ï¼‰
    deepseek  - è°ƒç”¨Deepseekæ¨¡å‹ï¼ˆéœ€è¦APIå¯†é’¥ï¼‰
  ç¤ºä¾‹ï¼š--llm-provider qwen

--llm-api-key KEY
  è¯´æ˜ï¼šLLM APIå¯†é’¥
  ä»…åœ¨ä½¿ç”¨qwenæˆ–deepseekæ—¶éœ€è¦
  ç¤ºä¾‹ï¼š--llm-api-key sk-abc123def456

--skip-cutting
  è¯´æ˜ï¼šè·³è¿‡æ•°æ®é›†è½¬æ¢ï¼Œä»…æ‰§è¡Œåˆ†æ
  ç±»å‹ï¼šå¸ƒå°”æ ‡å¿—ï¼ˆæ— å‚æ•°ï¼‰
  ç”¨é€”ï¼šå¿«é€Ÿåˆ†æï¼ŒæŸ¥çœ‹ç»“æœå†å†³å®šæ˜¯å¦è½¬æ¢
  ç¤ºä¾‹ï¼š--skip-cutting

--load-ranges FILE
  è¯´æ˜ï¼šåŠ è½½ä¹‹å‰ä¿å­˜çš„åˆ†æç»“æœ
  ç”¨é€”ï¼šé¿å…é‡å¤åˆ†æï¼Œç›´æ¥è¿›è¡Œæ•°æ®è½¬æ¢
  ç¤ºä¾‹ï¼š--load-ranges ./cut_dataset/frame_ranges_info.json

4ï¸âƒ£ ä½¿ç”¨æ¡ˆä¾‹
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Œ æ¡ˆä¾‹1ï¼šå¿«é€Ÿæµ‹è¯•ï¼ˆä»…åˆ†æï¼Œä¸è½¬æ¢ï¼‰
  
  python auto_cut_dataset.py --end-idx 10000 --skip-cutting
  
  ä¼˜ç‚¹ï¼šå¿«é€Ÿã€ä¸å ç”¨ç£ç›˜ç©ºé—´
  è¾“å‡ºï¼šcut_dataset/frame_ranges_info.json
  ç”¨é€”ï¼šæŸ¥çœ‹æ•°æ®ç»Ÿè®¡ï¼Œå†³å®šæ˜¯å¦ç»§ç»­å¤„ç†

ğŸ“Œ æ¡ˆä¾‹2ï¼šå®Œæ•´å¤„ç†ï¼ˆåˆ†æ+è½¬æ¢ï¼Œ100ä¸ªepisodeï¼‰
  
  python auto_cut_dataset.py --end-idx 10000 --max-episodes 100
  
  è¾“å‡ºï¼š
    â”œâ”€ cut_dataset/meta/episodes/chunk-000/file-000.parquet (2.5 MB)
    â”œâ”€ cut_dataset/meta/tasks.parquet (50 KB)
    â”œâ”€ cut_dataset/data/chunk-000/file-*.parquet (500+ MB)
    â””â”€ cut_dataset/frame_ranges_info.json (1.5 MB)
  æ€»å¤§å°ï¼š2-3 GB
  ç”¨é€”ï¼šç”Ÿæˆå®Œæ•´çš„ã€å¯ç”¨çš„æ•°æ®é›†

ğŸ“Œ æ¡ˆä¾‹3ï¼šå¤„ç†å®Œæ•´æ•°æ®é›†ï¼ˆæ‰€æœ‰æ•°æ®ï¼‰ğŸ¯
  
  # ä¸æŒ‡å®š --end-idxï¼Œè‡ªåŠ¨å¤„ç†æ‰€æœ‰æ•°æ®
  python auto_cut_dataset.py \
    --llm-provider local \
    --max-episodes 1000
  
  è¯´æ˜ï¼šä¸æŒ‡å®š --end-idx æ—¶ï¼Œå°†å¤„ç†å®Œæ•´æ•°æ®é›†
  è­¦å‘Šï¼šè¾“å‡ºéå¸¸å¤§ï¼ˆå¯èƒ½ 50+ GBï¼‰ï¼Œè¯·ç¡®ä¿ï¼š
    1. ç£ç›˜ç©ºé—´å……è¶³ï¼ˆå»ºè®® 100GB+ï¼‰
    2. é¢„ç•™è¶³å¤Ÿæ—¶é—´ï¼ˆå¯èƒ½éœ€è¦æ•°å°æ—¶ï¼‰
  ç”¨é€”ï¼šç”Ÿæˆå®Œæ•´çš„ç”Ÿäº§çº§è®­ç»ƒæ•°æ®é›†

ğŸ“Œ æ¡ˆä¾‹4ï¼šå¤„ç†æŒ‡å®šèŒƒå›´çš„æ•°æ®ï¼ˆæµ‹è¯•ç”¨ï¼‰
  
  python auto_cut_dataset.py --end-idx 100000 --max-episodes 500
  
  è¯´æ˜ï¼šæŒ‡å®š --end-idx å¯ä»¥æ§åˆ¶å¤„ç†èŒƒå›´
  ç”¨é€”ï¼šæµ‹è¯•æµç¨‹æˆ–ç”Ÿæˆä¸­ç­‰è§„æ¨¡æ•°æ®é›†

ğŸ“Œ æ¡ˆä¾‹5ï¼šä½¿ç”¨Azure OpenAI GPT-5ç”Ÿæˆç²¾å‡†ä»»åŠ¡æè¿°ï¼ˆæ¨èï¼‰â­
  
  # ç²¾ç»†æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰- ä¸Šä¼ 6å¸§å›¾åƒï¼Œè´¨é‡æœ€é«˜
  python auto_cut_dataset.py \
    --end-idx 500 \
    --before-frames 15 \
    --after-frames 10 \
    --llm-provider gpt \
    --llm-api-key 5ffef770a5b148c5920b7b16329e30fa \
    --llm-api-base https://gpt.yunstorm.com/ \
    --llm-api-version 2025-01-01-preview \
    --llm-model gpt-5 \
    --save-mode image
  
  # å¿«é€Ÿæ¨¡å¼ - ä»…ä¸Šä¼ 2å¸§å›¾åƒï¼Œé€Ÿåº¦æå‡3å€ ğŸš€
  python auto_cut_dataset.py \
    --end-idx 500 \
    --before-frames 15 \
    --after-frames 10 \
    --llm-provider gpt \
    --llm-api-key 5ffef770a5b148c5920b7b16329e30fa \
    --llm-api-base https://gpt.yunstorm.com/ \
    --llm-api-version 2025-01-01-preview \
    --llm-model gpt-5 \
    --llm-fast-mode \
    --save-mode image
  
  éœ€è¦ï¼šAzure OpenAI APIå¯†é’¥ï¼ˆä¼ä¸šè´¦å·ï¼‰
  
  æ¨¡å¼å¯¹æ¯”ï¼š
    ç²¾ç»†æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼š
      âœ“ ä¸Šä¼ 6å¸§å›¾åƒï¼ˆcam1å’Œcam2å„3å¸§ï¼šé¦–å¸§ã€å…³é”®å¸§ã€å°¾å¸§ï¼‰
      âœ“ æœ€é«˜è´¨é‡ï¼Œæœ€å‡†ç¡®çš„ç‰©ä½“è¯†åˆ«
      âœ“ é€‚åˆå¤æ‚åœºæ™¯å’Œå¤šç‰©ä½“ä»»åŠ¡
      âœ— å¤„ç†è¾ƒæ…¢ï¼ŒAPIæˆæœ¬è¾ƒé«˜
    
    å¿«é€Ÿæ¨¡å¼ï¼ˆ--llm-fast-modeï¼‰ï¼š
      âœ“ ä»…ä¸Šä¼ 2å¸§å›¾åƒï¼ˆcam1çš„é¦–å¸§å’Œå°¾å¸§ï¼‰
      âœ“ é€Ÿåº¦æå‡çº¦3å€ï¼ŒAPIæˆæœ¬é™ä½çº¦66%
      âœ“ é€‚åˆç®€å•åœºæ™¯å’Œå•ç‰©ä½“ä»»åŠ¡
      ~ è´¨é‡ç•¥æœ‰ä¸‹é™ï¼Œä½†é€šå¸¸è¶³å¤Ÿå‡†ç¡®
  
  å…¶ä»–ä¼˜ç‚¹ï¼š
    âœ“ ä½¿ç”¨æœ€æ–°GPT-5æ¨¡å‹ï¼ˆgpt-5-2025-08-07ï¼‰
    âœ“ æ”¯æŒå¤šæ¨¡æ€è§†è§‰ç†è§£
    âœ“ ç²¾å‡†è¯†åˆ«æ“ä½œå¯¹è±¡å’Œä½ç½®
    âœ“ ç”Ÿæˆè‡ªç„¶ã€å‡†ç¡®çš„ä»»åŠ¡æè¿°
  è€—æ—¶ï¼šå¿«é€Ÿæ¨¡å¼æ¯”ç²¾ç»†æ¨¡å¼å¿«3å€ï¼Œä½†ä»æ¯”æœ¬åœ°æ–¹æ³•æ…¢

ğŸ“Œ æ¡ˆä¾‹6ï¼šä½¿ç”¨Qwenç”Ÿæˆæ›´ç²¾å‡†çš„ä»»åŠ¡æè¿°
  
  python auto_cut_dataset.py \
    --llm-provider qwen \
    --llm-api-key sk-xxx \
    --end-idx 10000 \
    --max-episodes 100
  
  éœ€è¦ï¼šQwen APIå¯†é’¥
  ä¼˜ç‚¹ï¼šç”Ÿæˆçš„ä»»åŠ¡æè¿°æ›´è‡ªç„¶ã€å‡†ç¡®
  è€—æ—¶ï¼šæ¯”æœ¬åœ°æ–¹æ³•æ…¢5-10å€

ğŸ“Œ æ¡ˆä¾‹7ï¼šé‡å¤ä½¿ç”¨åˆ†æç»“æœ
  
  # ç¬¬ä¸€æ¬¡è¿è¡Œï¼ˆä»…åˆ†æï¼‰
  python auto_cut_dataset.py --end-idx 10000 --skip-cutting
  
  # ç¬¬äºŒæ¬¡è¿è¡Œï¼ˆç›´æ¥è½¬æ¢ï¼Œä½¿ç”¨ä¿å­˜çš„åˆ†æç»“æœï¼‰
  python auto_cut_dataset.py \
    --load-ranges cut_dataset/frame_ranges_info.json \
    --max-episodes 200
  
  ä¼˜ç‚¹ï¼šé¿å…é‡å¤åˆ†æï¼ŒèŠ‚çœæ—¶é—´
  ç”¨é€”ï¼šè°ƒæ•´episodeæ•°é‡æˆ–å…¶ä»–å‚æ•°

ğŸ“Œ æ¡ˆä¾‹8ï¼šæŒ‡å®šè¾“å‡ºç›®å½•
  
  python auto_cut_dataset.py \
    --output-dir /data/my_dataset \
    --end-idx 10000 \
    --max-episodes 100
  
  è¾“å‡ºåˆ°ï¼š/data/my_dataset/
  ç”¨é€”ï¼šç»„ç»‡å¤šä¸ªæ•°æ®é›†æˆ–ä½¿ç”¨å¤–éƒ¨å­˜å‚¨

ğŸ“Œ æ¡ˆä¾‹9ï¼šå¤§æ•°æ®é›†å¤„ç† + Checkpointä¿æŠ¤ï¼ˆæ¨èï¼‰ğŸ›¡ï¸
  
  # å¤„ç†å®Œæ•´æ•°æ®é›†ï¼ˆ270kå¸§ï¼‰ï¼Œå¸¦checkpointä¿æŠ¤
  python auto_cut_dataset.py \
    --llm-provider gpt \
    --llm-api-key 5ffef770a5b148c5920b7b16329e30fa \
    --llm-api-base https://gpt.yunstorm.com/ \
    --llm-api-version 2025-01-01-preview \
    --llm-model gpt-4o \
    --checkpoint-interval 10
  
  # å¦‚æœä¸­æ–­ï¼Œä»checkpointæ¢å¤
  python auto_cut_dataset.py \
    --llm-provider gpt \
    --llm-api-key 5ffef770a5b148c5920b7b16329e30fa \
    --llm-api-base https://gpt.yunstorm.com/ \
    --llm-api-version 2025-01-01-preview \
    --llm-model gpt-4o \
    --resume-from ./cut_dataset/checkpoints/checkpoint_latest.json
  
  # æˆ–ä½¿ç”¨äº¤äº’å¼è„šæœ¬
  bash scripts/run_with_checkpoint.sh
  
  ä¼˜åŠ¿ï¼š
    âœ“ è‡ªåŠ¨ä¿å­˜è¿›åº¦ï¼ˆæ¯10ä¸ªä»»åŠ¡ï¼‰
    âœ“ é”™è¯¯æ—¶ç«‹å³ä¿å­˜checkpoint
    âœ“ æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œä¸ä¸¢å¤±è¿›åº¦
    âœ“ å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†å¿…å¤‡
  
  Checkpointæ–‡ä»¶ä½ç½®ï¼š
    - checkpoint_latest.json: æœ€æ–°çŠ¶æ€ï¼ˆç”¨äºæ¢å¤ï¼‰
    - checkpoint_progress_*.json: å®šæœŸä¿å­˜
    - checkpoint_error_*.json: é”™è¯¯æ—¶ä¿å­˜
    - checkpoint_final.json: å®Œæˆæ—¶ä¿å­˜
  
  è¯¦ç»†æ–‡æ¡£ï¼šdocs/CHECKPOINT_GUIDE.md

5ï¸âƒ£ è¾“å‡ºè¯´æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

æ‰§è¡Œå®Œæˆåï¼Œè¾“å‡ºç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

cut_dataset/
â”œâ”€â”€ meta/
â”‚   â”œâ”€â”€ episodes/
â”‚   â”‚   â””â”€â”€ chunk-000/
â”‚   â”‚       â””â”€â”€ file-000.parquet          â† Episodeså…ƒæ•°æ®
â”‚   â”‚           åŒ…å«ï¼šepisode_index, tasks, dataset_from_index,
â”‚   â”‚                 dataset_to_index, length, action_typeç­‰
â”‚   â”œâ”€â”€ tasks.parquet                     â† ä»»åŠ¡åˆ—è¡¨
â”‚   â”‚   åŒ…å«ï¼šæ‰€æœ‰å”¯ä¸€çš„ä»»åŠ¡æè¿°
â”‚   â”œâ”€â”€ info.json                         â† æ•°æ®é›†ä¿¡æ¯
â”‚   â”‚   {
â”‚   â”‚     "total_episodes": 100,
â”‚   â”‚     "total_frames": 6000,
â”‚   â”‚     "total_tasks": 40,
â”‚   â”‚     "created_at": "2025-11-24T...",
â”‚   â”‚     "robot_type": "Panda 7-DOF",
â”‚   â”‚     "sampling_frequency": 10
â”‚   â”‚   }
â”‚   â””â”€â”€ stats.json                        â† ç»Ÿè®¡ä¿¡æ¯
â”‚       {
â”‚         "average_frames_per_episode": 60,
â”‚         "min_frames_per_episode": 55,
â”‚         "max_frames_per_episode": 65
â”‚       }
â”œâ”€â”€ data/
â”‚   â””â”€â”€ chunk-000/
â”‚       â”œâ”€â”€ file-000.parquet              â† å¸§æ•°æ®ï¼ˆ500 MBï¼‰
â”‚       â”œâ”€â”€ file-001.parquet
â”‚       â””â”€â”€ ...
â””â”€â”€ frame_ranges_info.json                â† åˆ†ææŠ¥å‘Š
    {
      "total_ranges": 100,
      "pick_count": 45,
      "place_count": 55,
      "frame_ranges": [
        {
          "id": 0,
          "keyframe_index": 100727,
          "action_type": "place",
          "frame_start": 100697,
          "frame_end": 100757,
          "num_frames": 60,
          "original_task": "put moka pot on stove",
          "new_task": "put the moka pot on the stove",
          "episode_index": 376
        },
        ...
      ]
    }

å¸§æ•°æ®æ–‡ä»¶å†…å®¹ï¼š
  æ¯ä¸ªparquetæ–‡ä»¶åŒ…å«å¤šå¸§æ•°æ®ï¼Œæ¯å¸§åŒ…æ‹¬ï¼š
    - observation.images.image (3, 256, 256)    â† RGBå›¾åƒ
    - observation.images.image2 (3, 256, 256)   â† ç¬¬äºŒä¸ªRGBå›¾åƒ
    - observation.state (8,)                     â† å…³èŠ‚çŠ¶æ€
    - action (7,)                                â† åŠ¨ä½œå‘é‡
    - timestamp (float)                          â† æ—¶é—´æˆ³

6ï¸âƒ£ å¸¸è§é—®é¢˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Q: ä¸ºä»€ä¹ˆæ£€æµ‹ä¸åˆ°å…³é”®å¸§ï¼Ÿ
A: å¯èƒ½åŸå› ï¼š
   1. å¤¹çˆªçŠ¶æ€å˜åŒ–ä¸æ˜æ˜¾
   2. ä¿®æ”¹gripper_detector.pyä¸­çš„thresholdå‚æ•°
   3. æ£€æŸ¥åŸå§‹æ•°æ®æ˜¯å¦åŒ…å«actionä¿¡æ¯

Q: å¦‚ä½•åªå¤„ç†ç‰¹å®šç±»å‹çš„æ“ä½œï¼ˆpickæˆ–placeï¼‰ï¼Ÿ
A: æ–¹æ¡ˆï¼š
   1. è¿è¡Œå®Œæ•´åˆ†æè·å¾—frame_ranges_info.json
   2. æ‰‹åŠ¨ç¼–è¾‘JSONæ–‡ä»¶ï¼Œåˆ é™¤ä¸éœ€è¦çš„æ“ä½œ
   3. é‡æ–°è¿è¡Œæ•°æ®è½¬æ¢

Q: ç£ç›˜ç©ºé—´ä¸è¶³æ€ä¹ˆåŠï¼Ÿ
A: è§£å†³æ–¹æ¡ˆï¼š
   1. å‡å°‘--end-idxèŒƒå›´
   2. é™ä½--max-episodesæ•°é‡
   3. åˆ é™¤ä¹‹å‰ç”Ÿæˆçš„cut_datasetå¹¶é‡æ–°ç”Ÿæˆ
   4. ä½¿ç”¨å¤–éƒ¨å­˜å‚¨ï¼š--output-dir /external/disk

Q: å¦‚ä½•æå‡ä»»åŠ¡æè¿°è´¨é‡ï¼Ÿ
A: æ–¹æ¡ˆï¼š
   1. ğŸŒŸ ä½¿ç”¨Azure OpenAI GPT-5ï¼ˆæ¨èï¼‰- æ”¯æŒè§†è§‰ç†è§£ï¼Œè´¨é‡æœ€é«˜
      python auto_cut_dataset.py \
        --llm-provider gpt \
        --llm-api-key YOUR_KEY \
        --llm-api-base https://gpt.yunstorm.com/ \
        --llm-api-version 2025-01-01-preview \
        --llm-model gpt-5
   2. ä½¿ç”¨Qwenæˆ–Deepseek LLMï¼ˆéœ€è¦APIï¼‰
   3. æ‰‹åŠ¨ç¼–è¾‘frame_ranges_info.jsonä¸­çš„new_task
   4. åœ¨Webç•Œé¢ä¸­è¿›è¡Œä¿®æ­£

Q: Azure OpenAIæ”¯æŒå“ªäº›æ¨¡å‹ï¼Ÿ
A: ç»æµ‹è¯•ï¼Œä»¥ä¸‹æ¨¡å‹å¯ç”¨ï¼ˆçº¯æ–‡æœ¬ï¼‰ï¼š
   âœ… gpt-5 (gpt-5-2025-08-07) - çº¯æ–‡æœ¬å¯ç”¨
   âœ… gpt-4.1 (gpt-4.1-2025-04-14)
   âœ… gpt-4.1-mini (gpt-4.1-mini-2025-04-14)
   âœ… gpt-4o (gpt-4o-2024-11-20)
   âœ… gpt-4o-mini (gpt-4o-mini-2024-07-18)
   âœ… gpt-4-turbo (å®é™…ä½¿ç”¨gpt-4.1)
   âŒ gpt-4, gpt-3.5-turboï¼ˆä¸æ”¯æŒï¼‰
   
   âš ï¸  æ³¨æ„ï¼šVisionï¼ˆå›¾åƒï¼‰åŠŸèƒ½åœ¨è¯¥ç«¯ç‚¹ä¸å¯ç”¨
   - çº¯æ–‡æœ¬è°ƒç”¨ï¼šâœ… æ­£å¸¸å·¥ä½œ
   - å›¾åƒè°ƒç”¨ï¼šâŒ è¿”å› 401 Unauthorized
   - åŸå› ï¼šVision åŠŸèƒ½æœªå¯ç”¨æˆ–éœ€è¦é¢å¤–æƒé™
   
   æµ‹è¯•å·¥å…·ï¼špython test_azure_gpt.py

Q: GPT Vision åŠŸèƒ½è¿”å› 401 é”™è¯¯æ€ä¹ˆåŠï¼Ÿ
A: è¿™æ˜¯å·²çŸ¥é—®é¢˜ï¼Œè¯¥ Azure OpenAI ç«¯ç‚¹ä¸æ”¯æŒ Vision åŠŸèƒ½ï¼š
   é”™è¯¯ä¿¡æ¯ï¼šResponse status code does not indicate success: 401 (Unauthorized)
   
   è§£å†³æ–¹æ¡ˆï¼š
   1. è”ç³»ç®¡ç†å‘˜å¯ç”¨ Vision åŠŸèƒ½æˆ–æä¾› Vision API Key
   2. ä½¿ç”¨æœ¬åœ°æ¨¡å¼ï¼š--llm-provider localï¼ˆæ— éœ€APIï¼‰
   3. ä½¿ç”¨å…¶ä»– LLMï¼š--llm-provider qwen æˆ– deepseek
   
   ä¸´æ—¶å‘½ä»¤ï¼ˆæœ¬åœ°æ¨¡å¼ï¼‰ï¼š
   python auto_cut_dataset.py \
     --end-idx 500 \
     --llm-provider local \
     --save-mode image

Q: è½¬æ¢å¤ªæ…¢æ€ä¹ˆåŠï¼Ÿ
A: ä¼˜åŒ–å»ºè®®ï¼š
   1. å‡å°‘--end-idxèŒƒå›´ï¼Œåˆ†æ‰¹å¤„ç†
   2. ä½¿ç”¨GPUåŠ é€Ÿï¼ˆä¿®æ”¹ä»£ç ä¸­çš„deviceï¼‰
   3. åœ¨SSDä¸Šè¿è¡Œ
   4. å¢åŠ å¸§æ‰¹å¤„ç†å¤§å°
   5. ä½¿ç”¨GPTå¿«é€Ÿæ¨¡å¼ï¼š--llm-fast-modeï¼ˆé€Ÿåº¦æå‡3å€ï¼‰

Q: å¤„ç†å¤§æ•°æ®é›†æ—¶å¦‚ä½•é˜²æ­¢æ•°æ®ä¸¢å¤±ï¼Ÿ
A: ä½¿ç”¨checkpointåŠŸèƒ½ï¼š
   1. å¯ç”¨è‡ªåŠ¨checkpointï¼š--checkpoint-interval 10
   2. ç¨‹åºä¼šæ¯10ä¸ªä»»åŠ¡ä¿å­˜ä¸€æ¬¡è¿›åº¦
   3. é”™è¯¯æ—¶è‡ªåŠ¨ä¿å­˜checkpoint
   4. ä¸­æ–­åä½¿ç”¨ --resume-from æ¢å¤
   
   ç¤ºä¾‹ï¼š
   # åˆå§‹è¿è¡Œ
   python auto_cut_dataset.py [å‚æ•°] --checkpoint-interval 10
   
   # å¦‚æœä¸­æ–­ï¼Œæ¢å¤è¿è¡Œ
   python auto_cut_dataset.py [ç›¸åŒå‚æ•°] \
     --resume-from ./cut_dataset/checkpoints/checkpoint_latest.json
   
   è¯¦è§ï¼šdocs/CHECKPOINT_GUIDE.md

Q: å¦‚ä½•æŸ¥çœ‹checkpointçŠ¶æ€ï¼Ÿ
A: æŸ¥çœ‹checkpointæ–‡ä»¶å†…å®¹ï¼š
   cat ./cut_dataset/checkpoints/checkpoint_latest.json | python -m json.tool
   
   åŒ…å«ä¿¡æ¯ï¼š
   - completed_tasks: å·²å®Œæˆçš„ä»»åŠ¡åˆ—è¡¨
   - completed_ranges: å·²å¤„ç†çš„ç´¢å¼•èŒƒå›´
   - timestamp: ä¿å­˜æ—¶é—´
   - total_completed: å®Œæˆæ€»æ•°

Q: checkpointæ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ
A: é»˜è®¤ä½ç½®ï¼š./cut_dataset/checkpoints/
   æ–‡ä»¶ç±»å‹ï¼š
   - checkpoint_latest.json: æœ€æ–°çŠ¶æ€ï¼ˆç”¨äºæ¢å¤ï¼‰
   - checkpoint_progress_*.json: å®šæœŸä¿å­˜çš„è¿›åº¦
   - checkpoint_error_*.json: é”™è¯¯æ—¶çš„çŠ¶æ€
   - checkpoint_final.json: å®Œæˆæ—¶çš„æœ€ç»ˆçŠ¶æ€

7ï¸âƒ£ æ•…éšœæ’é™¤
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

é”™è¯¯ï¼šModuleNotFoundError: No module named 'lerobot'
è§£å†³ï¼špip install lerobot

é”™è¯¯ï¼šCUDA out of memory
è§£å†³ï¼šè®¾ç½®CPUæ¨¡å¼
  export CUDA_VISIBLE_DEVICES=0
  æˆ–ä¿®æ”¹ä»£ç ä¸­deviceè®¾ç½®

é”™è¯¯ï¼šFileNotFoundError: dataset not found
è§£å†³ï¼šæ£€æŸ¥æ•°æ®é›†è·¯å¾„æ˜¯å¦æ­£ç¡®
  python auto_cut_dataset.py --dataset-path /correct/path

é”™è¯¯ï¼šå†…å­˜å ç”¨è¿‡é«˜
è§£å†³ï¼š
  1. å‡å°‘å¤„ç†èŒƒå›´
  2. é™ä½episodeé™åˆ¶
  3. ä½¿ç”¨æµå¼å¤„ç†ï¼ˆä¿®æ”¹ä»£ç ï¼‰

8ï¸âƒ£ æ‰©å±•å’Œè‡ªå®šä¹‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

è‡ªå®šä¹‰æ£€æµ‹é˜ˆå€¼
  ç¼–è¾‘gripper_detector.pyï¼Œä¿®æ”¹ç¬¬29è¡Œï¼š
    self.threshold = 0.5  # æ”¹ä¸ºä½ éœ€è¦çš„å€¼
  
  é˜ˆå€¼è¯´æ˜ï¼š
    < 0.3ï¼šæ•æ„Ÿï¼Œå®¹æ˜“è¯¯æ£€
    0.5ï¼šé»˜è®¤ï¼Œå¹³è¡¡
    > 0.8ï¼šä¿å®ˆï¼Œå¯èƒ½æ¼æ£€

è‡ªå®šä¹‰å¸§èŒƒå›´ï¼ˆä¸æ˜¯30å¸§ï¼‰
  ç¼–è¾‘auto_cut_dataset.pyï¼Œä¿®æ”¹ç¬¬89è¡Œï¼š
    ranges = detector.extract_frame_ranges(changes, context_frames=50)
  æ”¹ä¸ºä½ éœ€è¦çš„å¸§æ•°

æ·»åŠ è‡ªå®šä¹‰LLM
  åœ¨task_description_generator.pyä¸­ï¼š
  1. ç»§æ‰¿LLMProvideråŸºç±»
  2. å®ç°generate_task_description()æ–¹æ³•
  3. åœ¨TaskDescriptionGeneratorä¸­æ³¨å†Œ

é›†æˆå…¶ä»–æ•°æ®æº
  ä¿®æ”¹auto_cut_dataset.pyä¸­çš„load_lerobot_dataset()
  æ”¯æŒå…¶ä»–æ•°æ®æ ¼å¼

================================================================================
éœ€è¦å¸®åŠ©ï¼Ÿè¿è¡Œï¼špython auto_cut_dataset.py --help
================================================================================
