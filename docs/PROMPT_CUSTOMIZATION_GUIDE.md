# ğŸ“ å¦‚ä½•è‡ªå®šä¹‰ä»»åŠ¡æè¿°ç”Ÿæˆçš„ Prompt

## ğŸ“ Prompt ä½ç½®

æ‰€æœ‰çš„ Prompt éƒ½å®šä¹‰åœ¨ï¼š`task_description_generator.py` ä¸­çš„ `_build_prompt()` é™æ€æ–¹æ³•ã€‚

---

## ğŸ¯ ä¸‰ç§ Prompt å¯¹åº”çš„ä½ç½®

### 1ï¸âƒ£ **Qwen LLM çš„ Prompt** ï¼ˆç¬¬74-88è¡Œï¼‰

**æ–‡ä»¶è·¯å¾„**: `/home/dongyingyibadao/data_dealer_auto/task_description_generator.py`

**ç±»**: `QwenLLM`
**æ–¹æ³•**: `_build_prompt()` ï¼ˆé™æ€æ–¹æ³•ï¼‰

```python
@staticmethod
def _build_prompt(action_type: str, original_task: str, context: Dict = None) -> str:
    """æ„å»ºæç¤ºè¯"""
    return f"""
æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ªç®€æ´çš„æœºå™¨äººä»»åŠ¡æè¿°ï¼š

åŸå§‹ä»»åŠ¡: {original_task}
æ“ä½œç±»å‹: {'å¤¹çˆªå…³é—­ï¼ˆæŠ“å–ï¼‰' if action_type == 'pick' else 'å¤¹çˆªæ‰“å¼€ï¼ˆæ”¾ç½®ï¼‰'}

è¦æ±‚ï¼š
1. ä¿ç•™åŸå§‹ä»»åŠ¡ä¸­å…³é”®çš„ç‰©ä½“å’Œä½ç½®ä¿¡æ¯
2. æ ¹æ®æ“ä½œç±»å‹ï¼ˆpick/placeï¼‰ç”Ÿæˆå¯¹åº”çš„åŠ¨è¯
3. Pickæ“ä½œä½¿ç”¨"pick up"æˆ–"grab"ï¼ŒPlaceæ“ä½œä½¿ç”¨"put"æˆ–"place"
4. ç”Ÿæˆçš„æè¿°åº”è¯¥ç®€æ´ï¼Œä¸è¶…è¿‡20ä¸ªå•è¯
5. ä»…è¿”å›ç”Ÿæˆçš„æè¿°ï¼Œä¸éœ€è¦å…¶ä»–å†…å®¹

ç”Ÿæˆçš„ä»»åŠ¡æè¿°ï¼š
"""
```

### 2ï¸âƒ£ **Deepseek LLM çš„ Prompt** ï¼ˆç¬¬194-208è¡Œï¼‰

**ç±»**: `DeepseekLLM`
**æ–¹æ³•**: `_build_prompt()` ï¼ˆé™æ€æ–¹æ³•ï¼‰

> æ³¨æ„ï¼šDeepseek çš„ Prompt å’Œ Qwen çš„å®Œå…¨ç›¸åŒï¼ˆå½“å‰ï¼‰

### 3ï¸âƒ£ **GPT VLM çš„ Prompt**

**ç±»**: `GPTVLM`
**æ–¹æ³•**: `generate_task_description()`

GPT VLM çš„ Prompt ä½äº `generate_task_description` æ–¹æ³•å†…éƒ¨ï¼Œå› ä¸ºå®ƒéœ€è¦ç»“åˆå›¾åƒè¾“å…¥ã€‚

```python
            prompt = f"""
åŸå§‹ä»»åŠ¡æè¿°: "{original_task}"
åŠ¨ä½œç±»å‹: "{action_type}" (å¦‚æœæ˜¯pickï¼Œè¡¨ç¤ºæŠ“å–ï¼›å¦‚æœæ˜¯placeï¼Œè¡¨ç¤ºæ”¾ç½®)

è¯·æ ¹æ®æä¾›çš„é¦–å°¾å¸§å›¾åƒå’ŒåŸå§‹ä»»åŠ¡æè¿°ï¼Œç”Ÿæˆä¸€ä¸ªç®€çŸ­çš„ã€é’ˆå¯¹è¯¥ç‰‡æ®µçš„åŠ¨ä½œæè¿°ã€‚
æè¿°å¿…é¡»æ˜¯ "pick [object]" æˆ– "place [object] [location]" çš„æ ¼å¼ã€‚
åªè¿”å›æè¿°ï¼Œä¸è¦åŒ…å«å…¶ä»–æ–‡å­—ã€‚
"""
```

### 4ï¸âƒ£ **æœ¬åœ°ç”Ÿæˆçš„ Prompt** ï¼ˆç¬¬220-243è¡Œï¼‰

**æ–¹æ³•**: `_generate_local()` ï¼ˆé™æ€æ–¹æ³•ï¼‰

è¿™æ˜¯ä¸€ä¸ªåŸºäºè§„åˆ™çš„æœ¬åœ°æ–¹æ³•ï¼Œä¸ä½¿ç”¨ LLMï¼Œè€Œæ˜¯é€šè¿‡å…³é”®è¯æå–ç”Ÿæˆã€‚

---

## ğŸ› ï¸ å¦‚ä½•ä¿®æ”¹ Prompt

### æ–¹æ¡ˆAï¼šç›´æ¥ç¼–è¾‘æ–‡ä»¶ï¼ˆæ¨èç”¨äºå¾®è°ƒï¼‰

æ‰“å¼€æ–‡ä»¶å¹¶æ‰¾åˆ°ç›¸åº”çš„ `_build_prompt()` æ–¹æ³•ï¼Œä¿®æ”¹ `return` è¯­å¥ä¸­çš„å­—ç¬¦ä¸²å³å¯ã€‚

**ä¾‹å¦‚**ï¼Œå°†å½“å‰ Promptï¼š
```python
return f"""
æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ªç®€æ´çš„æœºå™¨äººä»»åŠ¡æè¿°ï¼š

åŸå§‹ä»»åŠ¡: {original_task}
æ“ä½œç±»å‹: {'å¤¹çˆªå…³é—­ï¼ˆæŠ“å–ï¼‰' if action_type == 'pick' else 'å¤¹çˆªæ‰“å¼€ï¼ˆæ”¾ç½®ï¼‰'}

è¦æ±‚ï¼š
1. ä¿ç•™åŸå§‹ä»»åŠ¡ä¸­å…³é”®çš„ç‰©ä½“å’Œä½ç½®ä¿¡æ¯
2. æ ¹æ®æ“ä½œç±»å‹ï¼ˆpick/placeï¼‰ç”Ÿæˆå¯¹åº”çš„åŠ¨è¯
3. Pickæ“ä½œä½¿ç”¨"pick up"æˆ–"grab"ï¼ŒPlaceæ“ä½œä½¿ç”¨"put"æˆ–"place"
4. ç”Ÿæˆçš„æè¿°åº”è¯¥ç®€æ´ï¼Œä¸è¶…è¿‡20ä¸ªå•è¯
5. ä»…è¿”å›ç”Ÿæˆçš„æè¿°ï¼Œä¸éœ€è¦å…¶ä»–å†…å®¹

ç”Ÿæˆçš„ä»»åŠ¡æè¿°ï¼š
"""
```

**æ”¹æˆ**ï¼ˆä¾‹å¦‚ï¼Œæ›´è¯¦ç»†çš„æŒ‡å¯¼ï¼‰ï¼š
```python
return f"""
ä½ æ˜¯ä¸€ä¸ªæœºå™¨äººæ“ä½œæè¿°ä¸“å®¶ã€‚æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œç”Ÿæˆç²¾ç¡®çš„æœºå™¨äººæ“ä½œæè¿°ã€‚

åŸå§‹ä»»åŠ¡è¯´æ˜: {original_task}
å½“å‰æ“ä½œç±»å‹: {'å¤¹çˆªé—­åˆï¼ˆæŠ“å–åŠ¨ä½œï¼‰' if action_type == 'pick' else 'å¤¹çˆªæ‰“å¼€ï¼ˆæ”¾ç½®åŠ¨ä½œï¼‰'}

ç”Ÿæˆè§„åˆ™ï¼š
1. ä½¿ç”¨ç®€å•ã€æ¸…æ™°çš„è‹±æ–‡è¡¨è¿°ï¼Œä¾¿äºæœºå™¨äººå­¦ä¹ 
2. å¦‚æœæ˜¯ pick æ“ä½œï¼Œå¼ºè°ƒ"ä»...ä½ç½®æŠ“å–..."
3. å¦‚æœæ˜¯ place æ“ä½œï¼Œå¼ºè°ƒ"æ”¾ç½®...åˆ°...ä½ç½®"
4. åŒ…å«å…·ä½“çš„ç‰©ä½“åç§°å’Œç›®æ ‡ä½ç½®
5. é¿å…ä½¿ç”¨æ¨¡ç³Šè¯æ±‡ï¼Œæ¯ä¸ªè¯éƒ½åº”è¯¥æœ‰æ˜ç¡®çš„å«ä¹‰
6. é•¿åº¦æ§åˆ¶åœ¨15-25ä¸ªå•è¯

è¯·ç»™å‡ºæœ€ç»ˆçš„æ“ä½œæè¿°ï¼ˆä»…è¿”å›æè¿°æœ¬èº«ï¼Œä¸éœ€è¦é¢å¤–è¯´æ˜ï¼‰ï¼š
"""
```

---

## ğŸ” å…³é”®å˜é‡è¯´æ˜

åœ¨ Prompt ä¸­å¯ä»¥ä½¿ç”¨çš„å˜é‡ï¼š

| å˜é‡ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `{action_type}` | æ“ä½œç±»å‹ï¼Œå€¼ä¸º 'pick' æˆ– 'place' | 'pick' |
| `{original_task}` | åŸå§‹ä»»åŠ¡æè¿°ï¼Œæ¥è‡ªæ•°æ®é›†å…ƒæ•°æ® | "put the white mug on the plate" |
| `{context}` | é¢å¤–ä¸Šä¸‹æ–‡ï¼ˆå¦‚ episode_indexï¼‰ | {'episode_index': 376} |

---

## ğŸ’¡ ä¼˜åŒ– Prompt çš„å»ºè®®

### é—®é¢˜1ï¼šç”Ÿæˆçš„æè¿°å¤ªé•¿
**åŸå› **ï¼šPrompt ä¸­çš„å­—æ•°é™åˆ¶ä¸ä¸¥æ ¼
**è§£å†³**ï¼š
```python
# æ”¹ä¸ºï¼š
4. ç”Ÿæˆçš„æè¿°åº”è¯¥ç®€æ´ï¼Œæ§åˆ¶åœ¨ 10-15 ä¸ªå•è¯ä»¥å†…
```

### é—®é¢˜2ï¼šä¸¢å¤±é‡è¦ä¿¡æ¯
**åŸå› **ï¼šPrompt è¦æ±‚å¤ªç®€æ´
**è§£å†³**ï¼š
```python
# æ”¹ä¸ºï¼š
4. ç”Ÿæˆçš„æè¿°åº”è¯¥åŒ…å«ï¼šåŠ¨è¯ã€ä¸»è¦ç‰©ä½“ã€ç›®æ ‡ä½ç½®ï¼Œé•¿åº¦15-25ä¸ªå•è¯
```

### é—®é¢˜3ï¼šPick å’Œ Place æè¿°é£æ ¼ä¸ä¸€è‡´
**åŸå› **ï¼šPrompt ç»™ä¸¤ç§æ“ä½œç›¸åŒçš„æŒ‡å¯¼
**è§£å†³**ï¼š
```python
if action_type == 'pick':
    return f"""
    æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ª"æŠ“å–"æ“ä½œçš„æè¿°ï¼š
    
    åŸå§‹ä»»åŠ¡: {original_task}
    
    è¦æ±‚ï¼š
    1. æè¿°ä»æŸå¤„æŠ“å–æŸç‰©ä½“
    2. æ ¼å¼ï¼š"pick up the [object] from the [location]"
    3. å¦‚æœåŸå§‹ä»»åŠ¡ä¸­æ²¡æœ‰å…·ä½“ä½ç½®ä¿¡æ¯ï¼Œæè¿°ä¸ºï¼š"pick up the [object]"
    ...
    """
else:  # place
    return f"""
    æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ª"æ”¾ç½®"æ“ä½œçš„æè¿°ï¼š
    
    åŸå§‹ä»»åŠ¡: {original_task}
    
    è¦æ±‚ï¼š
    1. æè¿°å°†æŸç‰©ä½“æ”¾ç½®åˆ°æŸå¤„
    2. æ ¼å¼ï¼š"put the [object] on/in the [location]"
    ...
    """
```

### é—®é¢˜4ï¼šç”Ÿæˆçš„ä»»åŠ¡æè¿°è´¨é‡ä¸ç¨³å®š
**åŸå› **ï¼šæ¸©åº¦å‚æ•°ï¼ˆtemperatureï¼‰å¯èƒ½å¤ªé«˜
**è§£å†³**ï¼šåœ¨ `generate_task_description()` æ–¹æ³•ä¸­ä¿®æ”¹ï¼š
```python
response = client.chat.completions.create(
    model=self.model,
    messages=[...],
    temperature=0.1,  # æ”¹å°è¿™ä¸ªå€¼ï¼Œä»0.3æ”¹ä¸º0.1ï¼ˆæ›´ç¡®å®šæ€§ï¼‰
    max_tokens=100
)
```

---

## ğŸš€ å®é™…ä¿®æ”¹ç¤ºä¾‹

å‡è®¾ä½ æƒ³è¦ç”Ÿæˆæ›´å…·ä½“çš„æè¿°ï¼ŒåŒ…å«åæ ‡æˆ–æ–¹å‘ä¿¡æ¯ï¼š

### ä¿®æ”¹å‰ï¼ˆå½“å‰ï¼‰ï¼š
```python
@staticmethod
def _build_prompt(action_type: str, original_task: str, context: Dict = None) -> str:
    """æ„å»ºæç¤ºè¯"""
    return f"""
æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œç”Ÿæˆä¸€ä¸ªç®€æ´çš„æœºå™¨äººä»»åŠ¡æè¿°ï¼š

åŸå§‹ä»»åŠ¡: {original_task}
æ“ä½œç±»å‹: {'å¤¹çˆªå…³é—­ï¼ˆæŠ“å–ï¼‰' if action_type == 'pick' else 'å¤¹çˆªæ‰“å¼€ï¼ˆæ”¾ç½®ï¼‰'}

è¦æ±‚ï¼š
1. ä¿ç•™åŸå§‹ä»»åŠ¡ä¸­å…³é”®çš„ç‰©ä½“å’Œä½ç½®ä¿¡æ¯
2. æ ¹æ®æ“ä½œç±»å‹ï¼ˆpick/placeï¼‰ç”Ÿæˆå¯¹åº”çš„åŠ¨è¯
3. Pickæ“ä½œä½¿ç”¨"pick up"æˆ–"grab"ï¼ŒPlaceæ“ä½œä½¿ç”¨"put"æˆ–"place"
4. ç”Ÿæˆçš„æè¿°åº”è¯¥ç®€æ´ï¼Œä¸è¶…è¿‡20ä¸ªå•è¯
5. ä»…è¿”å›ç”Ÿæˆçš„æè¿°ï¼Œä¸éœ€è¦å…¶ä»–å†…å®¹

ç”Ÿæˆçš„ä»»åŠ¡æè¿°ï¼š
"""
```

### ä¿®æ”¹åï¼ˆæ›´å…·ä½“ï¼‰ï¼š
```python
@staticmethod
def _build_prompt(action_type: str, original_task: str, context: Dict = None) -> str:
    """æ„å»ºæç¤ºè¯"""
    if action_type == 'pick':
        return f"""
ä½ æ˜¯ä¸€ä¸ªæœºå™¨äººæ“ä½œæè¿°ç”Ÿæˆå™¨ã€‚æ ¹æ®åŸå§‹ä»»åŠ¡ï¼Œç”Ÿæˆä¸€ä¸ª"æŠ“å–"æ“ä½œçš„ç®€æ´æè¿°ã€‚

åŸå§‹ä»»åŠ¡: {original_task}
æ“ä½œ: å¤¹çˆªé—­åˆï¼ˆå¼€å§‹æŠ“å–ï¼‰

è¦æ±‚ï¼š
1. æ ¼å¼ï¼š"[grab/pick up] the [object name]"ï¼ˆå¦‚æœæœ‰æ˜ç¡®çš„æ¥æºä½ç½®åˆ™åŠ ä¸Š "from the [source]"ï¼‰
2. åªæåŠä¸»è¦ç‰©ä½“ï¼Œä¸åŒ…æ‹¬å¤šä½™ä¿¡æ¯
3. ä½¿ç”¨ç‰©ä½“çš„å®Œæ•´åç§°ï¼ˆå¦‚ "white mug" è€Œä¸ä»…ä»…æ˜¯ "mug"ï¼‰
4. é•¿åº¦ 10-20 ä¸ªå•è¯
5. ä»…è¿”å›æ“ä½œæè¿°ï¼Œæ— éœ€å…¶ä»–å†…å®¹

ç”Ÿæˆçš„æ“ä½œæè¿°ï¼š
"""
    else:  # place
        return f"""
ä½ æ˜¯ä¸€ä¸ªæœºå™¨äººæ“ä½œæè¿°ç”Ÿæˆå™¨ã€‚æ ¹æ®åŸå§‹ä»»åŠ¡ï¼Œç”Ÿæˆä¸€ä¸ª"æ”¾ç½®"æ“ä½œçš„ç®€æ´æè¿°ã€‚

åŸå§‹ä»»åŠ¡: {original_task}
æ“ä½œ: å¤¹çˆªæ‰“å¼€ï¼ˆå¼€å§‹æ”¾ç½®ï¼‰

è¦æ±‚ï¼š
1. æ ¼å¼ï¼š"[put/place] the [object name] [on/in/at] the [destination]"
2. æ˜ç¡®æŒ‡å‡ºç‰©ä½“æ”¾åœ¨å“ªé‡Œï¼ˆon the table, in the microwave, ç­‰ï¼‰
3. ä½¿ç”¨ç‰©ä½“å’Œç›®æ ‡åœ°ç‚¹çš„å®Œæ•´åç§°
4. é•¿åº¦ 10-20 ä¸ªå•è¯
5. ä»…è¿”å›æ“ä½œæè¿°ï¼Œæ— éœ€å…¶ä»–å†…å®¹

ç”Ÿæˆçš„æ“ä½œæè¿°ï¼š
"""
```

---

## ğŸ“ æç¤ºå·¥ç¨‹ (Prompt Engineering) æœ€ä½³å®è·µ

1. **å…·ä½“ vs é€šç”¨**ï¼šä¸è¦å¤ªé€šç”¨ï¼Œä½†ä¹Ÿè¦è¶³å¤Ÿçµæ´»å¤„ç†ä¸åŒä»»åŠ¡
2. **ç¤ºä¾‹**ï¼šå¯ä»¥åœ¨ Prompt ä¸­æ·»åŠ ç¤ºä¾‹æ¥æŒ‡å¯¼ LLM
3. **çº¦æŸæ¡ä»¶**ï¼šæ˜ç¡®è¯´æ˜è¾“å‡ºçš„æ ¼å¼å’Œé•¿åº¦é™åˆ¶
4. **è§’è‰²è®¾å®š**ï¼šæ˜ç¡®å‘Šè¯‰ LLM å®ƒçš„è§’è‰²ï¼ˆ"ä½ æ˜¯ä¸€ä¸ªæœºå™¨äººæ“ä½œæè¿°ç”Ÿæˆå™¨"ï¼‰
5. **è´Ÿé¢æŒ‡å¯¼**ï¼šè¯´æ˜ä¸è¦åšä»€ä¹ˆï¼Œæœ‰æ—¶æ¯”è¯´æ˜è¦åšä»€ä¹ˆæ›´æœ‰æ•ˆ

---

## ğŸ“Š æµ‹è¯•ä¿®æ”¹

ä¿®æ”¹ Prompt åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•æ•ˆæœï¼š

```bash
cd /home/dongyingyibadao/data_dealer_auto

# ç”Ÿæˆå°‘é‡æ ·æœ¬æ¥å¿«é€ŸéªŒè¯
python auto_cut_dataset.py \
  --end-idx 1000 \
  --max-episodes 10 \
  --llm-provider qwen \
  --llm-api-key sk-2882d263d05a4d36a56fc4d50ccb2961 \
  --skip-cutting

# ç„¶åæŸ¥çœ‹ç”Ÿæˆçš„æè¿°
cat cut_dataset/frame_ranges_info.json | head -100
```

è¿™æ ·å¯ä»¥å¿«é€Ÿçœ‹åˆ°æ•ˆæœï¼Œè€Œä¸éœ€è¦å¤„ç†å¤§é‡æ•°æ®ã€‚

---

## ğŸ“‹ æ€»ç»“

| è¦ä¿®æ”¹çš„å†…å®¹ | ä½ç½® | æ–‡ä»¶ |
|------------|------|------|
| Qwen Prompt | `QwenLLM._build_prompt()` | task_description_generator.py (ç¬¬74-88è¡Œ) |
| Deepseek Prompt | `DeepseekLLM._build_prompt()` | task_description_generator.py (ç¬¬194-208è¡Œ) |
| æœ¬åœ°è§„åˆ™ | `_generate_local()` | task_description_generator.py (ç¬¬220-243è¡Œ) |
| å…¶ä»–å‚æ•° | `generate_task_description()` | task_description_generator.py (ç¬¬56-71è¡Œ) |
| æ¸©åº¦å‚æ•° | `temperature=0.3` | task_description_generator.py (ç¬¬66è¡Œ) |
| æœ€å¤§ä»¤ç‰Œæ•° | `max_tokens=100` | task_description_generator.py (ç¬¬67è¡Œ) |

ç°åœ¨ä½ å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±ä¿®æ”¹ Prompt äº†ï¼ğŸ˜Š
